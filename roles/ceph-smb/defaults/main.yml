---
# Update samba packages if already installed
upgrade_samba_packages: true

# Roles
samba_server: true
samba_cluster: true
domain_member: true

# Which backend_fs to use. Currently only cephfs supported
backend_fs: cephfs

## Cephfs Options
samba_keyring:
  - { name: client.samba, caps: { mds: "allow r path=/, allow rwps path=/fsgw", mon: "allow r", osd: "allow *" }, mode: "0600" }
shared_storage_mountpoint: /mnt/cephfs

## Samba Server (SMB) Settings
# Global options
include_overrides: true

samba_global_options:
  netbios_name: 'SMBCLUSTER'
  server_string: 'Samba %v'
  idmap_range: '10000-99999'
  log_level: '0'

# Domain Authentication (Winbind) Settings
# Todo add support for choice of sssd or winbind
active_directory_info:
  workgroup: 'SAMDOM'
  idmap_range: '100000 - 999999'
  realm: 'SAMDOM.COM'
  winbind_enum_groups: yes
  winbind_enum_users: yes
  winbind_use_default_domain: yes
  # "domain_join_user" user used to join the domain. Needs only permission for joins, not full admin.
  domain_join_user: ''
  domain_join_password: ''
  # "ad_admin_user" and "ad_admin_group" are used to administer permissions on shares.
  # Defaults to join user credentials, replace below if join user and admin user are different
  ad_admin_user: ''
  ad_admin_password: ''
  ad_admin_group: "Domain Admins"

# Samba Share (SMB) Definitions
# Path is relative to cephfs root
configure_shares: true
enable_windows_acl: true
samba_shares:
  - name: 'public'
    path: '/fsgw/public'
    type: 'vfs'
    windows_acl: false
    writeable: 'yes'
    guest_ok: 'yes'
    comment: "public rw access"
    ceph_snapshots: true
    worm: false

  - name: 'secure'
    path: '/fsgw/secure'
    type: 'kernel'
    windows_acl: true    
    writeable: 'yes'
    guest_ok: 'no'
    comment: "secure rw access"
    ceph_snapshots: true
    worm: false

## Samba Cluster (CTDB) Settings
ctdb_public_addresses:
  - vip_address: '192.168.103.10'
    vip_interface: 'eth0'
    subnet_mask: '16'

ctdb_tunables:
  - key: 'ControlTimeout'
    value: '15'
  - key: 'ElectionTimeout'
    value: '2'
  - key: 'KeepaliveInterval'
    value: '1'
  - key: 'KeepaliveLimit'
    value: '3'
  - key: 'MonitorInterval'
    value: '5'
  - key: 'TakeoverTimeout'
    value: '5'

# If setting up multiple ctdb clusters that use the cluster backend, choose a new lock name or else ctdb will never start due to lock contention
ctdb_lock_name: ctdb_lock

# Dont touch 
rados_locking: true

